!function(e,n){"object"==typeof exports&&"undefined"!=typeof module?n(exports):"function"==typeof define&&define.amd?define(["exports"],n):n((e=e||self).veriffSDK={})}(this,function(c){"use strict";function d(){return"undefined"==typeof window}function f(e){e=e||navigator.userAgent;var n=/(iPad).*OS\s([\d_]+)/.test(e);return{ios:!n&&/(iPhone\sOS)\s([\d_]+)/.test(e)||n,android:/(Android);?[\s/]+([\d.]+)?/.test(e)}}function l(e){e.cancelable&&e.preventDefault()}function s(e){e||null!==e&&"production"!==process.env.NODE_ENV&&console.warn("If scrolling is also required in the floating layer, the target element must be provided.")}function E(e){d()||(s(e),0<--V||(f().ios||"function"!=typeof H?(e&&(Array.isArray(e)?e:[e]).forEach(function(e){var n=U.indexOf(e);-1!==n&&(e.ontouchmove=null,e.ontouchstart=null,U.splice(n,1))}),P&&(document.removeEventListener("touchmove",l,k),P=!1)):H()))}function r(e){for(var n=Array(e.length),t=0;t<e.length;++t)n[t]=e[t];return n}function m(e){return Array.isArray(e)?e:[e]}function o(e,n){var t=e.tabIndex-n.tabIndex,o=e.index-n.index;if(t){if(!e.tabIndex)return 1;if(!n.tabIndex)return-1}return t||o}function p(e,n,t){return r(e).map(function(e,n){return{node:e,index:n,tabIndex:t&&-1===e.tabIndex?(e.dataset||{}).focusGuard?0:-1:e.tabIndex}}).filter(function(e){return!n||0<=e.tabIndex}).sort(o)}function h(e,t){return e.reduce(function(e,n){return e.concat(r(n.querySelectorAll(t?K:W)),n.parentNode?r(n.parentNode.querySelectorAll(G.join(","))).filter(function(e){return e===n}):[])},[])}function t(e){return!e||e===document||e.nodeType===Node.DOCUMENT_NODE||!(!(!(n=window.getComputedStyle(e,null))||!n.getPropertyValue)&&("none"===n.getPropertyValue("display")||"hidden"===n.getPropertyValue("visibility")))&&t(e.parentNode);var n}function u(e,n){return(n=1<arguments.length&&void 0!==n?n:[]).push(e),e.parentNode&&u(e.parentNode,n),n}function v(e,n){for(var t=u(e),o=u(n),r=0;r<t.length;r+=1){var i=t[r];if(0<=o.indexOf(i))return i}return!1}function y(e){return r(e).filter(t).filter(function(e){return!(("INPUT"===(e=e).tagName||"BUTTON"===e.tagName)&&("hidden"===e.type||e.disabled))})}function g(e,n){return p(y(h(e,n)),!0,n)}function b(e){return y(function(e){e=e.querySelectorAll("[data-autofocus-inside]");return r(e).map(function(e){return h([e])}).reduce(function(e,n){return e.concat(n)},[])}(e))}function i(e){return"INPUT"===e.tagName&&"radio"===e.type}function a(n,e){return e.filter(i).filter(function(e){return e.name===n.name}).filter(function(e){return e.checked})[0]||n}function S(e){return e[0]&&1<e.length&&i(e[0])&&e[0].name?a(e[0],e):e[0]}function R(e,n){return 1<e.length&&i(e[n])&&e[n].name?e.indexOf(a(e[n],e)):n}function F(t){for(var e=t.length,o=0;o<e;o+=1)for(var n=0;n<e;n+=1){var r=function(n){if(o!==n&&t[o].contains(t[n]))return{v:F(t.filter(function(e){return e!==t[n]}))}}(n);if("object"===(void 0===r?"undefined":Q(r)))return r.v}return t}function A(e){return e.parentNode?A(e.parentNode):e}function w(e){return m(e).filter(Boolean).reduce(function(e,n){var t=n.getAttribute(q);return e.push.apply(e,t?F(r(A(n).querySelectorAll("["+q+'="'+t+'"]:not([data-focus-lock-disabled="disabled"])'))):[n]),e},[])}function I(e){return e&&e.dataset&&e.dataset.focusGuard}function _(e){return!I(e)}function N(e,n){var t,o,r,i=document&&document.activeElement,u=w(e).filter(_),e=(f=e,t=u,a=m(a=i||e),f=m(f),o=a[0],r=null,f.filter(Boolean).forEach(function(e){r=v(r||e,e)||r,t.filter(Boolean).forEach(function(e){e=v(o,e);e&&(r=!r||e.contains(r)?e:v(e,r))})}),r),a=g(u).filter(function(e){e=e.node;return _(e)});if(a[0]||(a=p(y(h(u)),!1).filter(function(e){e=e.node;return _(e)}))[0]){var c,d,f=g([e]).map(function(e){return e.node}),a=(e=f,a=a,c=new Map,a.forEach(function(e){return c.set(e.node,e)}),e.map(function(e){return c.get(e)}).filter(Boolean)),e=a.map(function(e){return e.node}),u=function(e,n,t,o,r){var i=e.length,u=e[0],a=e[i-1],c=I(t);if(!(0<=e.indexOf(t))){var d=n.indexOf(t),f=n.indexOf(o||d),t=e.indexOf(o),o=d-f,f=n.indexOf(u),u=n.indexOf(a),n=R(e,0),a=R(e,i-1);return-1===d||-1===t?e.indexOf(r&&r.length?S(r):S(e)):!o&&0<=t?t:d<=f&&c&&1<Math.abs(o)?a:f<=d&&c&&1<Math.abs(o)?n:o&&1<Math.abs(o)?t:d<=f?a:u<d?n:o?1<Math.abs(o)?t:(i+t+o)%i:void 0}}(e,f,i,n,e.filter((d=u.reduce(function(e,n){return e.concat(b(n))},[]),function(e){return!!e.autofocus||e.dataset&&!!e.dataset.autofocus||0<=d.indexOf(e)})));return void 0===u?u:a[u]}}function x(e){return e===document.activeElement}function T(e){var o=document&&document.activeElement;return!(!o||o.dataset&&o.dataset.focusGuard)&&w(e).reduce(function(e,n){return e||n.contains(o)||(n=r((n=n).querySelectorAll("iframe")),t=x,!!n.filter(function(e){return e===t})[0]);var t},!1)}function D(){return document&&document.activeElement===document.body||document&&r(document.querySelectorAll("[data-no-focus-lock]")).some(function(e){return e.contains(document.activeElement)})}function n(){var e,n=!1;return Y&&(e=Y,D()||(e&&!T(e)&&(n=function(e,n){n=N(e,n);if(!X&&n){if(2<z)return console.error("FocusLock: focus-fighting detected. Only one focus management system could be active. See https://github.com/theKashey/focus-lock/#focus-fighting"),X=!0,void setTimeout(function(){X=!1},1);z++,(n=n.node).focus(),n.contentWindow&&n.contentWindow.focus(),z--}}(e,J)),J=document.activeElement)),n}function O(){var e;return e=Z.filter(function(e){return e}).slice(-1)[0],(Y=e)&&n(),!1}var L,e,V=0,C=0,M=0,H=null,P=!1,U=[],k=function(e){if(d())return!1;if(!e)throw new Error("options must be provided");function n(){}var t=!1,o={get passive(){t=!0}},r="__TUA_BSL_TEST_PASSIVE__";return window.addEventListener(r,n,o),window.removeEventListener(r,n,o),o=e.capture,t?e:void 0!==o&&o}({passive:!1}),j=!d()&&"scrollBehavior"in document.documentElement.style,B=function(e){var n,t,o,r,i,u,a;d()||(s(e),f().ios?(e&&(Array.isArray(e)?e:[e]).forEach(function(n){n&&-1===U.indexOf(n)&&(n.ontouchstart=function(e){C=e.targetTouches[0].clientY,M=e.targetTouches[0].clientX},n.ontouchmove=function(e){1===e.targetTouches.length&&function(e,n){if(n){var t=n.scrollTop,o=n.scrollLeft,r=n.scrollWidth,i=n.scrollHeight,u=n.clientWidth,a=n.clientHeight,c=e.targetTouches[0].clientX-M,d=e.targetTouches[0].clientY-C,n=Math.abs(d)>Math.abs(c);if(n&&(0<d&&0===t||d<0&&i<=t+a+1)||!n&&(0<c&&0===o||c<0&&r<=o+u+1))return l(e)}e.stopPropagation()}(e,n)},U.push(n))}),P||(document.addEventListener("touchmove",l,k),P=!0)):V<=0&&(H=f().android?(o=document.documentElement,r=document.body,i=o.scrollTop||r.scrollTop,u=Object.assign({},o.style),a=Object.assign({},r.style),o.style.height="100%",o.style.overflow="hidden",r.style.top="-".concat(i,"px"),r.style.width="100%",r.style.height="auto",r.style.position="fixed",r.style.overflow="hidden",function(){o.style.height=u.height||"",o.style.overflow=u.overflow||"",["top","width","height","overflow","position"].forEach(function(e){r.style[e]=a[e]||""}),j?window.scrollTo({top:i,behavior:"instant"}):window.scrollTo(0,i)}):(n=document.body,t=Object.assign({},n.style),e=window.innerWidth-n.clientWidth,n.style.overflow="hidden",n.style.boxSizing="border-box",n.style.paddingRight="".concat(e,"px"),function(){["overflow","boxSizing","paddingRight"].forEach(function(e){n.style[e]=t[e]||""})})),V+=1)},G=["button:enabled:not([readonly])","select:enabled:not([readonly])","textarea:enabled:not([readonly])","input:enabled:not([readonly])","a[href]","area[href]","iframe","object","embed","[tabindex]","[contenteditable]","[autofocus]"],q="data-focus-lock",W=G.join(","),K=W+", [data-focus-guard]",Q="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},z=0,X=!1,Y=0,J=null,Z=[],$={on:function(e){0===Z.length&&document.addEventListener("focusin",O),Z.indexOf(e)<0&&(Z.push(e),O())},off:function(n){Z=Z.filter(function(e){return e!==n}),O(),0===Z.length&&document.removeEventListener("focusin",O)}};(e=L=L||{}).VERIFF_HANDSHAKE="VERIFF_HANDSHAKE",e.VERIFF_RENDER="VERIFF_RENDER",e.VERIFF_STARTED="VERIFF_STARTED",e.VERIFF_FINISHED="VERIFF_FINISHED",e.VERIFF_CANCELED="VERIFF_CANCELED",e.VERIFF_FORCE_RELOAD="VERIFF_FORCE_RELOAD",e.VERIFF_RELOAD_REQUEST="VERIFF_RELOAD_REQUEST",(e=c.MESSAGES||(c.MESSAGES={})).STARTED="STARTED",e.FINISHED="FINISHED",e.CANCELED="CANCELED",e.RELOAD_REQUEST="RELOAD";var ee="\n  position: fixed !important;\n  top: 0 !important;\n  right: 0 !important;\n  bottom: 0 !important;\n  left: 0 !important;\n  z-index: 9999999;\n  display: block !important;\n  width: 100vw;\n  height: 100%;\n  margin: 0 !important;\n  padding: 0 !important;\n  overflow: auto;\n  -webkit-overflow-scrolling: touch;\n  background: rgba(0, 0, 0, 0.6);\n",ne="\n  position: absolute !important;\n  top: 0 !important;\n  right: 0 !important;\n  bottom: 0 !important;\n  left: 0 !important;\n  width: 100vw;\n  height: 100%;\n  margin: 0 !important;\n  padding: 0 !important;\n  background: none;\n  border: none\n",te="veriffFrame";function oe(e){var n=document.createElement("iframe");n.src=e,n.allow="autoplay; camera; microphone; fullscreen; accelerometer; magnetometer; gyroscope; picture-in-picture;",n.id=te,n.style.cssText=ne;e=document.createElement("div");return e.style.cssText=ee,e.appendChild(n),document.body.appendChild(e),$.on(n),B(n),n}c.createVeriffFrame=function(e){var n=e.url,t=e.lang,o=e.onEvent,r=void 0===o?function(){}:o,i=e.onReload;if(!n)throw new Error("URL is not provided. Please provide a valid Veriff session url.");function u(){var e,n=document.getElementById(te);n&&n.parentNode?($.off(n),E(n),(e=n.parentNode.parentNode)&&e.removeChild(n.parentNode)):E(),window.removeEventListener("message",a)}function a(e){var n,t=document.getElementById(te);e.data===L.VERIFF_HANDSHAKE&&null!==(n=t.contentWindow)&&void 0!==n&&n.postMessage({name:L.VERIFF_RENDER,payload:{isFullScreenSupported:!0,isReloadHandled:"function"==typeof i,version:"1.3.1"}},"*"),e.data===L.VERIFF_STARTED&&r(c.MESSAGES.STARTED),e.data===L.VERIFF_CANCELED&&(u(),r(c.MESSAGES.CANCELED)),e.data===L.VERIFF_FINISHED&&(u(),r(c.MESSAGES.FINISHED)),e.data===L.VERIFF_FORCE_RELOAD&&window.location.reload(),e.data===L.VERIFF_RELOAD_REQUEST&&("function"==typeof i&&i(),r(c.MESSAGES.RELOAD_REQUEST))}return t&&0<t.length?oe(function(e,n,t){if(t){var o=new URL(e),r=o.searchParams;return r.set(n,t),o.search=r.toString(),o.toString()}return e}(n,"lang",t)):oe(n),window.addEventListener("message",a),{close:u}},Object.defineProperty(c,"__esModule",{value:!0})});
